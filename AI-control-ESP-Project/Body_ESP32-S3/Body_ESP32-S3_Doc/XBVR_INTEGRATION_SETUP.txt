================================================================================
 XBVR + BODY ESP ML INTEGRATION - COMPLETE SETUP GUIDE
 VR Films met Biometric-Enhanced Funscript Control
================================================================================

📅 Datum: 23 September 2025
🎯 Doel: XBVR funscripts koppelen aan Body ESP met ML autonomy
🌐 Network: Alles op hetzelfde WiFi netwerk

================================================================================
 📋 BENODIGDE SOFTWARE
================================================================================

HOOFD COMPONENTEN:
✅ XBVR (je hebt al)
✅ Body ESP (met ML Autonomy slider)
✅ VR Headset software (SteamVR/Oculus)

EXTRA SOFTWARE (optioneel maar handig):
🔧 Buttplug.io Intiface Central (backup methode)
🔧 MultiFunPlayer (alternatieve controller)
🔧 ScriptPlayer (standalone funscript player)
🔧 Advanced IP Scanner (vind ESP32 IP adres)

DEVELOPMENT TOOLS (als je wilt tweaken):
🛠️ Arduino IDE (voor ESP32 code aanpassingen)
🛠️ Postman (voor API testing)
🛠️ WebSocket King (voor WebSocket debugging)

================================================================================
 🔧 XBVR INTEGRATIE OPTIES (UPDATED)
================================================================================

⚠️  BELANGRIJK: XBVR Discord Feedback ⚠️
XBVR heeft GEEN officiële externe API. De APIs zijn intern en niet 
bedoeld voor algemeen gebruik. Er zijn 3 betere opties:

OPTIE 1: BUTTPLUG.IO BRIDGE (AANBEVOLEN)
1. Install Buttplug.io Intiface Central
2. XBVR → Intiface Central → Body ESP
3. Stabiel en veilig, geen XBVR modificatie

OPTIE 2: MULTIFUNPLAYER (ALTERNATIEF)
1. Install MultiFunPlayer
2. Laad funscript in MultiFunPlayer
3. MultiFunPlayer → WebSocket → Body ESP
4. Meer controle over timing en intensiteit

OPTIE 3: CUSTOM SCRIPT PLAYER (ADVANCED)
1. Build eigen funscript player
2. Parse .funscript files direct
3. Sync met video playback
4. Complete controle over timing

⚠️  OPTIE 4: XBVR INTERNAL API (RISICO)
- Reverse engineer via browser dev tools
- Geen documentatie, kan data corrumperen
- Alleen voor test installatie
- Niet aanbevolen voor productie gebruik

================================================================================
 🔧 BUTTPLUG.IO SETUP (AANBEVOLEN METHODE)
================================================================================

STAP 1: INSTALL INTIFACE CENTRAL
1. Download: https://intiface.com/central/
2. Install en start Intiface Central
3. Go to Settings → Server Settings
4. Enable "WebSocket Server" op poort 12345
5. Start Intiface Server

STAP 2: XBVR BUTTPLUG CONFIGURATIE
1. Open XBVR → Settings → Devices
2. Enable "Buttplug.io Integration"
3. Server URL: ws://localhost:12345
4. Test connection (moet "Connected" tonen)

STAP 3: BODY ESP ALS BUTTPLUG DEVICE
1. Body ESP implementeert Buttplug.io WebSocket client
2. Connect naar Intiface Central als "LinearActuator" device
3. XBVR → Intiface → Body ESP ML processing

================================================================================
 🔧 MULTIFUNPLAYER SETUP (ALTERNATIEF)
================================================================================

STAP 1: INSTALL MULTIFUNPLAYER
1. Download: https://github.com/Yoooi0/MultiFunPlayer
2. Extract en run MultiFunPlayer.exe
3. Configure Output → WebSocket
4. Set endpoint: ws://[ESP32-IP]:81/ws

STAP 2: SCRIPT LOADING
1. Load .funscript file in MultiFunPlayer
2. Sync met video player (VLC/MPC/XBVR)
3. Real-time script streaming naar Body ESP

================================================================================
 🌐 NETWORK SETUP
================================================================================

IP ADRESSEN CHECKEN:
1. XBVR PC: ipconfig → noteer IP (bijv. 192.168.1.100)
2. Body ESP: Serial Monitor → noteer WiFi IP (bijv. 192.168.1.151)
3. Zorg dat beide op hetzelfde subnet zitten

FIREWALL INSTELLINGEN:
Windows Firewall:
- Allow XBVR.exe through firewall
- Allow inbound connections on port 9998 (WebSocket)
- Allow outbound connections naar ESP32 IP

PORT OVERZICHT:
- 9999: XBVR Web Interface
- 9998: XBVR WebSocket API (configureerbaar)
- 80: Body ESP WebServer
- 81: Body ESP WebSocket (zullen we maken)

================================================================================
 📱 BODY ESP CONFIGURATIE
================================================================================

NETWORK SETTINGS (in Body ESP code):
```cpp
// WiFi credentials (zelfde netwerk als XBVR PC)
const char* ssid = "JouwWiFiNetwerk";
const char* password = "JouwWiFiWachtwoord";

// XBVR Server details
const char* xbvrHost = "192.168.1.100";  // IP van XBVR PC
const int xbvrPort = 9998;               // WebSocket port
```

ML AUTONOMY INSTELLINGEN:
Via Menu → AI → ML Eigenwil:
- Start met 30% voor testen
- 0% = Alleen funscript wordt gevolgd
- 50% = Funscript + ML aanpassingen
- 100% = ML heeft volledige controle

================================================================================
 🔄 CONNECTION WORKFLOW
================================================================================

OPSTARTEN VOLGORDE:
1. Start XBVR op PC
2. Start Body ESP (controleer WiFi verbinding via Serial)
3. Check XBVR Device Status (moet "Connected" tonen)
4. Test met eenvoudige video + funscript

TROUBLESHOOTING CONNECTIE:
Als verbinding mislukt:
1. Ping ESP32: `ping 192.168.1.151`
2. Check XBVR logs: Settings → System → View Logs
3. Check ESP32 Serial output voor WebSocket errors
4. Test WebSocket handmatig met WebSocket King tool

================================================================================
 🎮 TESTING PROCEDURE
================================================================================

STAP 1: BASIS CONNECTIE TEST
1. Open XBVR web interface
2. Ga naar Devices → Body ESP ML
3. Click "Test Connection"
4. Check ESP32 Serial voor incoming WebSocket data

STAP 2: FUNSCRIPT PLAYBACK TEST
1. Load een korte testvideo met funscript
2. Set ML Autonomy op 0% (pure funscript)
3. Start playback
4. Verify hardware volgt funscript pattern

STAP 3: ML AUTONOMY TEST
1. Zelfde video, set ML Autonomy op 50%
2. Monitor Serial output voor ML decisions
3. Verify hardware reageert op biometric changes
4. Test verschillende autonomy percentages

STAP 4: VR INTEGRATION TEST
1. Start VR headset software
2. Open XBVR in VR mode
3. Play VR video met funscript
4. Test immersive experience met ML adjustments

================================================================================
 📊 MONITORING & DEBUG
================================================================================

XBVR MONITORING:
- Web Interface → System → Real-time Logs
- Device Status indicators
- WebSocket connection status
- Script timing statistics

BODY ESP MONITORING:
Serial Output zal tonen:
```
[XBVR] Connected to WebSocket at 192.168.1.100:9998
[XBVR] Received: pos=75 speed=80 timestamp=45230
[ML] Biometrics: HR=95 Temp=37.2 GSR=650 StressLevel=3
[ML] Autonomy=50% Override=YES: pos=75→60 speed=80→4
[HARDWARE] Motor: pos=60 speed=4 vibe=ON suction=OFF
```

NETWORK DEBUGGING TOOLS:
- Wireshark: Monitor WebSocket traffic
- Advanced IP Scanner: Find device IP addresses  
- Postman: Test XBVR API endpoints manually
- WebSocket King: Test WebSocket connections

================================================================================
 🎯 OPTIMALISATIE TIPS
================================================================================

PERFORMANCE OPTIMIZATION:
1. Use wired network connection voor XBVR PC (geen WiFi)
2. Set XBVR WebSocket update rate naar 60Hz
3. Use high-quality WiFi voor ESP32 (5GHz als mogelijk)
4. Minimize network latency (router QoS settings)

ML AUTONOMY TUNING:
- Start conservatief (20-30%)
- Monitor biometric responses
- Gradually increase autonomy as comfort improves
- Use feedback buttons voor ML learning

SCRIPT COMPATIBILITY:
- Test met verschillende funscript types
- Some scripts zijn meer compatible dan anderen
- Complex multi-axis scripts might need custom handling

================================================================================
 🚀 ADVANCED FEATURES (TOEKOMST)
================================================================================

GEPLANDE UITBREIDINGEN:
1. 📈 Real-time biometric graphing in XBVR
2. 🎯 Custom ML models per video genre
3. 📱 Mobile app voor remote autonomy control
4. 🕐 Time-based autonomy scheduling
5. 👥 Multi-user profiles met verschillende ML settings
6. 📊 Session analytics en performance tracking

CUSTOM INTEGRATIONS:
- XBVR Plugin development
- Custom funscript generation based on biometrics
- Integration met andere VR platforms
- Voice control via speech recognition
- Haptic feedback integration

================================================================================
 ⚠️ TROUBLESHOOTING GUIDE
================================================================================

COMMON ISSUES:

🔴 "WebSocket Connection Failed"
→ Check IP addresses
→ Check firewall settings
→ Verify XBVR WebSocket enabled
→ Test with Postman/WebSocket King

🔴 "Funscript Not Loading"
→ Check file format (.funscript)
→ Verify script timing matches video
→ Check XBVR script folder settings

🔴 "ML Not Responding"
→ Check sensor connections
→ Verify ML Autonomy > 0%
→ Check Serial output voor biometric data

🔴 "Hardware Not Moving"
→ Check power supply
→ Verify motor connections
→ Test without ML (direct commands)

🔴 "High Latency"
→ Check network performance
→ Reduce WebSocket update rate
→ Use wired connection voor PC

EMERGENCY STOPS:
- C button op Body ESP (altijd werkend)
- Space bar in XBVR (emergency pause)
- VR controller emergency button
- Power switch (laatste resort)

================================================================================
 📞 SUPPORT RESOURCES
================================================================================

XBVR COMMUNITY:
- Reddit: r/XBVR
- Discord: XBVR Community Server
- GitHub: XBVR Issues/Documentation

BUTTPLUG.IO RESOURCES:
- Official docs: buttplug.io/docs
- GitHub: buttplug-rs repository
- Discord: Buttplug.io Community

ESP32 DEVELOPMENT:
- Arduino ESP32 docs
- ESP32 WebSocket libraries
- Arduino community forums

================================================================================
 ✅ FINAL CHECKLIST
================================================================================

BEFORE FIRST RUN:
☐ XBVR configured and API enabled
☐ Body ESP flashed met ML Autonomy code
☐ Both devices on same WiFi network
☐ IP addresses verified and accessible
☐ Test video + funscript available
☐ VR headset ready and configured
☐ Emergency stops tested and working

TIJDENS TESTING:
☐ Monitor Serial output
☐ Check XBVR connection status
☐ Verify biometric sensors working
☐ Test ML autonomy at different levels
☐ Emergency stop procedures verified

NA SUCCESVOLLE TEST:
☐ Save optimal ML autonomy settings
☐ Document working configuration
☐ Plan regular system updates
☐ Enjoy the future of VR! 🚀

================================================================================
 🎉 KLAAR VOOR DE TOEKOMST!
================================================================================

Met deze setup heb je de meest geavanceerde VR experience ter wereld:
- Real-time biometric feedback
- ML-enhanced funscript adaptation  
- Intelligente stress management
- Personalized autonomy control

Je Body ESP wordt de eerste biometrisch-responsive VR controller met 
machine learning! Dit is echt next-level technology. 

Laat me weten als je hulp nodig hebt met de implementatie! 🤖✨

================================================================================